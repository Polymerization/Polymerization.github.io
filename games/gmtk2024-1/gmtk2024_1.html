<!DOCTYPE html><html><head><meta charset="utf-8"><style>html,body,div,canvas{margin:0;padding:0}</style><title>GMTK2024</title></head><body> <div class="fullscreen"> <canvas id="myCanvas" width="800" height="600"></canvas> </div> <script>var n,e,t,r={},u=r={};function o(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function c(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{e="function"==typeof clearTimeout?clearTimeout:i}catch(n){e=i}}();var a=[],f=!1,l=-1;function v(){f&&t&&(f=!1,t.length?a=t.concat(a):l=-1,a.length&&s())}function s(){if(!f){var n=c(v);f=!0;for(var r=a.length;r;){for(t=a,a=[];++l<r;)t&&t[l].run();l=-1,r=a.length}t=null,f=!1,function(n){if(e===clearTimeout)return clearTimeout(n);if((e===i||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(n);try{e(n)}catch(t){try{return e.call(null,n)}catch(t){return e.call(this,n)}}}(n)}}function m(n,e){this.fun=n,this.array=e}function h(){}u.nextTick=function(n){var e=Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];a.push(new m(n,e)),1!==a.length||f||c(s)},m.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=h,u.addListener=h,u.once=h,u.off=h,u.removeListener=h,u.removeAllListeners=h,u.emit=h,u.prependListener=h,u.prependOnceListener=h,u.listeners=function(n){return[]},u.binding=function(n){throw Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(n){throw Error("process.chdir is not supported")},u.umask=function(){return 0},(()=>{var n,e,t,u,o,i,c,a,f,l,v,s,m,h,w,y,p,d,x,g,b,T,L,D,E,F,A,M,R,C,S,q,k,V,z,N,O,j,B,U={compose:function(n){return function(e){return function(t){return n(e(t))}}}},X=function(n){return n.identity},Y={identity:function(n){return n},Semigroupoid0:function(){return U}},I=function(n){return function(e){return function(t){return n(t)(e)}}},P=function(n){return function(e){return n}},G=void 0,H=function(n){return n.map},J=X(Y),K=function(n){return n.apply},Q=function(n){return n.pure},W=function(n){var e=K(n.Apply0()),t=Q(n);return function(n){return function(r){return e(t(n))(r)}}},Z=function(n){return n.bind},$=function(n){return n};String.fromCharCode(65535);var _=function(n){return function(e){return function(t){return function(r){return function(u){return r<u?n:r===u?e:t}}}}},nn=function(n){return function(e){return n===e}},ne={eq:nn},nt={eq:nn},nr=function(){function n(){}return n.value=new n,n}(),nu=function(){function n(){}return n.value=new n,n}(),no=function(){function n(){}return n.value=new n,n}(),ni={add:function(n){return function(e){return n+e|0}},zero:0,mul:function(n){return function(e){return n*e|0}},one:1},nc={sub:function(n){return function(e){return n-e|0}},Semiring0:function(){return ni}},na={compare:_(nr.value)(no.value)(nu.value),Eq0:function(){return ne}},nf={compare:_(nr.value)(no.value)(nu.value),Eq0:function(){return nt}},nl=function(n){return n.compare},nv=function(n){var e=nl(n);return function(n){return function(t){var r=e(n)(t);if(r instanceof nr)return t;if(r instanceof no||r instanceof nu)return n;throw Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[r.constructor.name])}}},ns=function(n){return n.append},nm=X(Y),nh=function(){function n(){}return n.value=new n,n}(),nw=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),ny=function(n){return function(e){return function(t){if(t instanceof nh)return n;if(t instanceof nw)return e(t.value0);throw Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},np=ny(!1)(P(!0)),nd=function(n){return ny(n)(nm)},nx=isFinite,ng=Math.abs,nb=Math.acos,nT=Math.cos,nL=Math.floor,nD=function(n){return function(e){return Math.pow(n,e)}},nE=Math.round,nF=Math.sin,nA=Math.sqrt,nM=(b=nw.create,function(n){return function(e){return(0|e)===e?b(e):n}})(nh.value),nR=function(n){return nx(n)?n>=$(2147483647)?2147483647:n<=$(-2147483648)?-2147483648:nd(0)(nM(n)):0},nC=function(n){var e=Z(n.Bind1()),t=Q(n.Applicative0());return function(n){return function(r){return e(n)(function(n){return e(r)(function(e){return t(n(e))})})}}},nS={Ring0:function(){return nc}},nq=function(n){return n.mod},nk={degree:function(n){return Math.min(Math.abs(n),2147483647)},div:function(n){return function(e){return 0===e?0:e>0?Math.floor(n/e):-Math.floor(-(n/e))}},mod:function(n){return function(e){if(0===e)return 0;var t=Math.abs(e);return(n%t+t)%t}},CommutativeRing0:function(){return nS}},nV=function(n){return n.mempty},nz=function(n,e,t){var r,u=0;return function(o){if(2===u)return r;if(1===u)throw ReferenceError(n+" was needed before it finished initializing (module "+e+", line "+o+")",e,o);return u=1,r=t(),u=2,r}},nN={Applicative0:function(){return nj},Bind1:function(){return nO}},nO={bind:function(n){return function(e){return function(){return e(n())()}}},Apply0:function(){return nU(0)}},nj={pure:function(n){return function(){return n}},Apply0:function(){return nU(0)}},nB=nz("functorEffect","Effect",function(){return{map:W(nj)}}),nU=nz("applyEffect","Effect",function(){return{apply:nC(nN),Functor0:function(){return nB(0)}}});function nX(n){return function(){throw n}}function nY(n){return function(e){return function(){n.fillStyle=e}}}function nI(n){return function(e){return function(){n.rotate(e)}}}function nP(n){return function(e){return function(){n.translate(e.translateX,e.translateY)}}}var nG=function(n){return nX(Error(n))()},nH=function(n){return function(e){return function(){n.save();var t=e();return n.restore(),t}}};Array.prototype.fill;var nJ=function(n){return function(e){return function(){return n(e)}}},nK=nJ(function(n){return n}),nQ=nJ(function(n){return n.slice()}),nW=(T=function(n,e){return e.push(n)},function(n){return function(e){return function(){return T(n,e)}}}),nZ=function(n){return n.disj},n$={ff:!1,tt:!0,implies:function(n){return function(e){return nZ(n$)(n$.not(n))(e)}},conj:function(n){return function(e){return n&&e}},disj:function(n){return function(e){return n||e}},not:function(n){return!n}},n_=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),n0=function(n){var e=nZ(n);return{append:function(n){return function(t){return e(n)(t)}}}},n1=function(n){var e=n0(n);return{mempty:n.ff,Semigroup0:function(){return e}}},n3=function(n){return n.foldr},n2=function(n){return n.foldl},n5=function(n){var e=n3(n);return function(n){var t=ns(n.Semigroup0()),r=nV(n);return function(n){return e(function(e){return function(r){return t(n(e))(r)}})(r)}}},n4={foldr:function(n){return function(e){return function(t){for(var r=e,u=t.length,o=u-1;o>=0;o--)r=n(t[o])(r);return r}}},foldl:function(n){return function(e){return function(t){for(var r=e,u=t.length,o=0;o<u;o++)r=n(r)(t[o]);return r}}},foldMap:function(n){return n5(n4)(n)}},n8=function(n){return function(e){return function(t){return n(e,t)}}},n6=n8(function(n,e){return n[e]}),n7=(L=function(n,e,t){return 0===t.length?n({}):e(t[0])(t.slice(1))},function(n){return function(e){return function(t){return L(n,e,t)}}})(P(nh.value))(function(n){return function(e){return new nw({head:n,tail:e})}}),n9=n8(function(n,e){for(var t=n>e?-1:1,r=Array(t*(e-n)+1),u=n,o=0;u!==e;)r[o++]=u,u+=t;return r[o]=u,r}),en=function(){function n(){}return n.value=new n,n}(),ee=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),et={foldr:function(n){return function(e){var t,r=(t=en.value,function(n){for(var e,r=t,u=!1;!u;)e=function(e,t){if(t instanceof en)return u=!0,e;if(t instanceof ee){r=new ee(t.value0,e),n=t.value1;return}throw Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[e.constructor.name,t.constructor.name])}(r,n);return e}),u=n2(et)(I(n))(e);return function(n){return u(r(n))}}},foldl:function(n){return function(e){return function(t){for(var r,u=e,o=!1;!o;)r=function(e,r){if(r instanceof en)return o=!0,e;if(r instanceof ee){u=n(e)(r.value0),t=r.value1;return}throw Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[r.constructor.name])}(u,t);return r}}},foldMap:function(n){var e=ns(n.Semigroup0()),t=nV(n);return function(n){return n2(et)(function(t){var r=e(t);return function(e){return r(n(e))}})(t)}}},er=n2(et),eu=n3(et),eo={unfoldr1:function(n){return function(e){return function(t){for(var r,u=e,o=!1;!o;)r=function(e,r){var i=n(e);if(i.value1 instanceof nw){u=i.value1.value0,t=new ee(i.value0,r);return}if(i.value1 instanceof nh)return o=!0,er(I(ee.create))(en.value)(new ee(i.value0,r));throw Error("Failed pattern match at Data.List.Types (line 135, column 22 - line 137, column 61): "+[i.constructor.name])}(u,t);return r}(en.value)}}},ei=H({map:function(n){return function(e){return e instanceof nw?new nw(n(e.value0)):nh.value}}}),ec=n2(et),ea=(D=en.value,function(n){for(var e,t=D,r=!1;!r;)e=function(e,u){if(u instanceof en)return r=!0,e;if(u instanceof ee){t=new ee(u.value0,e),n=u.value1;return}throw Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[e.constructor.name,u.constructor.name])}(t,n);return e}),ef=ec(function(n){return function(e){return n+1|0}})(0),el=function(n){var e;return e=en.value,function(t){for(var r,u=e,o=!1;!o;)r=function(e,r){if(r instanceof en)return o=!0,ea(e);if(r instanceof ee){if(n(r.value0)){u=new ee(r.value0,e),t=r.value1;return}u=e,t=r.value1;return}throw Error("Failed pattern match at Data.List (line 390, column 3 - line 390, column 27): "+[e.constructor.name,r.constructor.name])}(u,t);return r}},ev=function(n){return function(e){return 0===n&&e instanceof ee?new nw(e.value1):e instanceof ee?ei(function(n){return new ee(e.value0,n)})(ev(n-1|0)(e.value1)):nh.value}},es=nq(nk),em=function(n){if(n instanceof nw)return n.value0;throw Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[n.constructor.name])},eh=function(n){var e;return(e=es(n)(2147483645))<1?e+2147483646|0:e},ew=function(n){var e;return em(nM((e=$(48271)*$(n)+$(0),function(n){return e%n})($(2147483647))))},ey=H({map:function(n){return function(e){return function(){return n(e())}}}})(P(G)),ep=nq(nk),ed=function(n){return n.randomR},ex=function(n){var e=(n.Random0(),function(n){return function(e){return function(t){var r;return(r=function(r){return function(){var u,o={value:t};return(u=function(e){return function(){var e,t=n(o.value);return ey((e=t.newSeed,function(n){return function(){return n.value=e}})(o))(),ey(nW(t.newVal)(r))()}},function(){for(var n=0;n<e;n++)u(n)()})()}},function(n){return function(){var e=nQ(n)();return r(e)(),nK(e)()}})([])()}}}),t=ed(n);return function(n){return function(r){return e(t(n)(r))}}},eg={random:function(n){var e=ew(n);return{newVal:e,newSeed:e}}},eb=function(n){return n.random},eT=eb(eg),eL={random:function(n){var e=eT(n);return{newVal:$(e.newVal)/$(2147483647),newSeed:e.newSeed}}},eD=eb(eL),eE={randomR:function(n){return function(e){return function(t){if(n>e)return ed(eE)(e)(n)(t);var r=eT(t);return{newVal:ep(r.newVal)((e-n|0)+1|0)+n|0,newSeed:r.newSeed}}}},Random0:function(){return eg}},eF={randomR:function(n){return function(e){return function(t){if(n>e)return ed(eF)(e)(n)(t);var r=eD(t);return{newVal:r.newVal*(e-n)+n,newSeed:r.newSeed}}}},Random0:function(){return eL}},eA=nv(nf),eM=function(n){return function(e){return n+e}},eR=(t=function(n){return function(e){return function(t){for(var r,u=e,o=!1;!o;)r=function(e,r){var i=n(e);if(i instanceof nh)return o=!0,er(I(ee.create))(en.value)(r);if(i instanceof nw){u=i.value0.value1,t=new ee(i.value0.value0,r);return}throw Error("Failed pattern match at Data.List.Types (line 142, column 22 - line 144, column 52): "+[i.constructor.name])}(u,t);return r}(en.value)}},function(n){var e=n.length;return t(function(t){return t<e?new nw(new n_(n6(n)(t),t+1|0)):nh.value})(0)}),eC=H({map:function(n){var e;return e=en.value,function(t){for(var r,u=e,o=!1;!o;)r=function(e,r){if(r instanceof ee&&r.value1 instanceof ee&&r.value1.value1 instanceof ee){u=new ee(r,e),t=r.value1.value1.value1;return}return o=!0,function(t){for(var r,u=e,o=!1;!o;)r=function(e,r){if(e instanceof ee&&e.value0 instanceof ee&&e.value0.value1 instanceof ee&&e.value0.value1.value1 instanceof ee){u=e.value1,t=new ee(n(e.value0.value0),new ee(n(e.value0.value1.value0),new ee(n(e.value0.value1.value1.value0),r)));return}return o=!0,r}(u,t);return r}(r instanceof ee&&r.value1 instanceof ee&&r.value1.value1 instanceof en?new ee(n(r.value0),new ee(n(r.value1.value0),en.value)):r instanceof ee&&r.value1 instanceof en?new ee(n(r.value0),en.value):en.value)}(u,t);return r}}}),eS=(u=et.foldMap,function(n){return u(n1(n))})(n$),eq=(o=nl(na),E=function(n){return function(e){var t=o(n)(e);if(t instanceof nr||t instanceof no)return n;if(t instanceof nu)return e;throw Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[t.constructor.name])}},F=nv(na),function(n){return function(e){return function(t){return E(e)(F(n)(t))}}}),ek=ns({append:function(n){return function(e){return eu(ee.create)(e)(n)}}}),eV=U.compose,ez=function(n){return n.toString()},eN=(c=K(i=nj.Apply0()),a=H(i.Functor0()),A=function(n){return function(e){return c(a(P(J))(n))(e)}},M=Q(nj),function(n){var e=n3(n);return function(n){return e(function(e){return A(n(e))})(M(G))}})(et),eO=H({map:function(n){return function(e){for(var t=e.length,r=Array(t),u=0;u<t;u++)r[u]=n(e[u]);return r}}}),ej=n2(n4),eB=n2(et),eU=n3(et),eX=function(){function n(){}return n.value=new n,n}(),eY=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),eI=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),eP=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),eG=function(){function n(){}return n.value=new n,n}(),eH=function(){function n(){}return n.value=new n,n}(),eJ=function(){function n(){}return n.value=new n,n}(),eK=function(){function n(){}return n.value=new n,n}(),eQ=function(){function n(){}return n.value=new n,n}(),eW=function(){function n(){}return n.value=new n,n}(),eZ=function(){function n(){}return n.value=new n,n}(),e$={x:0,y:0},e_=function(n){return{x:n.x,y:n.y,rotDeg:n.rotDeg,vel:n.vel,score:n.score,collects:n.collects,avoids:n.avoids,spawns:n.spawns,level:n.level,comboLevel:n.comboLevel,combo:n.combo,comboTime:n.comboTime,high:eA(n.score)(n.high)}},e0=function(n){var e=ex(n);return function(n){return function(t){return function(r){return function(u){var o=n7(e(n)(t)(r+1|0)(u));if(o instanceof nw)return eR(o.value0.tail);if(o instanceof nh)return nG("unreachable");throw Error("Failed pattern match at Lib (line 555, column 31 - line 557, column 46): "+[o.constructor.name])}}}}},e1=e0(eE),e3=e0(eF),e2=function(n){return function(e){return e1(0)(2e9)(n)(e)}},e5=function(n){return ng(n)},e4=function(n){return -1*ng(n)},e8=function(n){return{rotDeg:n.rotDeg,vel:n.vel,score:n.score,collects:n.collects,avoids:n.avoids,spawns:n.spawns,level:n.level,high:n.high,comboLevel:n.comboLevel,combo:n.combo,comboTime:n.comboTime,x:n.x+n.vel.x,y:n.y+n.vel.y}},e6=function(n){return{x:n.x,y:n.y,rotDeg:n.rotDeg,vel:n.vel,score:n.score,collects:n.collects,spawns:n.spawns,level:n.level,high:n.high,comboLevel:n.comboLevel,combo:n.combo,comboTime:n.comboTime,avoids:eC(function(n){return{vel:n.vel,x:n.x+n.vel.x,y:n.y+n.vel.y}})(n.avoids)}},e7=function(n){return{x:400,y:300,rotDeg:0,vel:{x:0,y:0},score:0,collects:new ee({x:100,y:100},en.value),avoids:new ee({x:600,y:450,vel:e$},en.value),spawns:en.value,level:0,high:n,comboLevel:0,combo:0,comboTime:nh.value}},e9={input:{up:!1,left:!1,right:!1},game:eX.value},tn=function(n){return function(e){var t=e3(0)(800)(2)(eh(n));if(t instanceof ee&&t.value1 instanceof ee&&t.value1.value1 instanceof en){var r=eq(e)(600-e)(t.value1.value0);return{x:eq(e)(800-e)(t.value0),y:r}}return nG("unreachable")}},te=function(n){return n.x<0||n.x>800||n.y<0||n.y>600},tt=function(n){return function(e){return function(t){return function(r){var u=nD(r-e)(2);return nA(nD(t-n)(2)+u)}}}},tr=function(n){return function(e){return function(t){return function(r){var u=tt(n)(e)(t)(r);return{x:0===u?0:(t-n)/u,y:0===u?0:(r-e)/u}}}}},tu=function(n){return 3.14159265359*n/180},to=function(n){return eS(function(e){return 30>tt(n.x)(n.y)(e.x)(e.y)})(n.avoids)},ti=function(n){return{x:n.x,y:n.y,rotDeg:n.rotDeg,vel:n.vel,score:n.score,collects:n.collects,spawns:n.spawns,level:n.level,high:n.high,comboLevel:n.comboLevel,combo:n.combo,comboTime:n.comboTime,avoids:eC(function(n){var e=n.y<0?e5(n.vel.y):n.y>600?e4(n.vel.y):n.vel.y,t=n.x<0?e5(n.vel.x):n.x>800?e4(n.vel.x):n.vel.x,r=function(){if(1>tt(0)(0)(t)(e))return{x:t,y:e};var n=tr(0)(0)(t)(e);return{x:.3*n.x,y:.3*n.y}}();return n.x<0||n.x>800||n.y<0||n.y>600?{x:eq(0)(800)(n.x),y:eq(0)(600)(n.y),vel:{x:r.x,y:r.y}}:n})(n.avoids)}},tc=function(n){var e,t,r,u=(t=eO(function(n){return n<=5?.5:n<=20?.2:.05})((e=n.score)>0?n9(0)(e-1|0):[]),ej(eM)(0)(t)),o=function(n){return function(e){return function(t){var r=tr(n.x)(n.y)(e.x)(e.y),u=.5*t/tt(n.x)(n.y)(e.x)(e.y);return{x:r.x*u,y:r.y*u}}}},i=(r=eC(function(e){return o({x:n.x,y:n.y})({x:e.x,y:e.y})(20)})(n.avoids),eB(function(n){return function(e){return{x:n.x+e.x,y:n.y+e.y}}})(e$)(r));return{rotDeg:n.rotDeg,vel:n.vel,score:n.score,collects:n.collects,spawns:n.spawns,level:n.level,high:n.high,comboLevel:n.comboLevel,combo:n.combo,comboTime:n.comboTime,x:n.x+i.x,y:n.y+i.y,avoids:eC(function(e){var t=o({x:e.x,y:e.y})({x:n.x,y:n.y})(u);return{x:e.x,y:e.y,vel:{x:e.vel.x+t.x,y:e.vel.y+t.y}}})(n.avoids)}},ta=function(n){var e;return{x:n.x,y:n.y,rotDeg:n.rotDeg,vel:n.vel,score:n.score,collects:n.collects,spawns:n.spawns,level:n.level,high:n.high,comboLevel:n.comboLevel,combo:n.combo,comboTime:n.comboTime,avoids:eC(function(e){var t,r,u=(t=n.avoids,function(n){var e=ev(n)(t);if(e instanceof nw){var r=function(n){for(var e,r=t,u=!1;!u;)e=function(e,t){if(e instanceof en)return u=!0,nh.value;if(e instanceof ee&&0===t)return u=!0,new nw(e.value0);if(e instanceof ee){r=e.value1,n=t-1|0;return}throw Error("Failed pattern match at Data.List (line 281, column 1 - line 281, column 44): "+[e.constructor.name,t.constructor.name])}(r,n);return e}(n);if(r instanceof nw)return new n_(r.value0,e.value0);if(r instanceof nh)return nG("unreachable");throw Error("Failed pattern match at Lib (line 550, column 18 - line 552, column 48): "+[r.constructor.name])}if(e instanceof nh)return nG("unreachable");throw Error("Failed pattern match at Lib (line 549, column 23 - line 553, column 46): "+[e.constructor.name])})(e);return(r=u.value0,function(n){var e=function(n){return function(e){var t,r,u,o=tr(0)(0)(n.vel.x)(n.vel.y),i=tr(n.x)(n.y)(e.x)(e.y),c=eq(0)(90)((t={x:n.x,y:n.y},r=tt(0)(0)(t.x)(t.y),u=tt(0)(0)(i.x)(i.y),180*nb((i.x*t.x+i.y*t.y)/(u*r))/3.14159265359))/90,a=tt(0)(0)(n.vel.x)(n.vel.y);return{x:o.x*c*a,y:o.y*c*a}}},t=el(function(n){return 35>tt(r.x)(r.y)(n.x)(n.y)})(n),u=eB(function(n){return function(t){var u=e(t)(r);return{x:n.x+u.x,y:n.y+u.y}}})(e$)(t),o=eB(function(n){return function(t){var u=e(r)(t);return{x:n.x+u.x,y:n.y+u.y}}})(e$)(t);return{x:r.x,y:r.y,vel:{x:r.vel.x+u.x-o.x,y:r.vel.y+u.y-o.y}}})(u.value1)})((e=ef(n.avoids))>0?eR(n9(0)(e-1|0)):en.value)}};function tf(n){var e=[],t=n;return{subscribe:function(n){e.push(n),n(t)},get:function(){return t},set:function(n){t=n,e.forEach(function(e){e(n)})}}}var tl={map:function(n){return function(e){var t=tf(n(e.get()));return e.subscribe(function(e){t.set(n(e))}),t}}},tv=H(tl),ts=function(n){return function(e){return function(t){var r;return tv(nd(e))((r=new nw(e),function(n){var e=tf(np(n.get())?n.get():r);return n.subscribe(function(n){np(n)&&e.set(n)}),e})(tv(n)(t)))}}};function tm(){var n="undefined"!=typeof performance?performance:null,e=void 0!==r?r:null;return(n&&(n.now||n.webkitNow||n.msNow||n.oNow||n.mozNow)||e&&e.hrtime&&function(){var n=e.hrtime();return(1e9*n[0]+n[1])/1e6}||Date.now).call(n)}var th=function(n){return function(){var e=tf(!1);return window.addEventListener("keydown",function(t){t.keyCode===n&&e.set(!0)}),window.addEventListener("keyup",function(t){t.keyCode===n&&e.set(!1)}),e}},tw=Z(nO),ty=Q(nj),tp=H(tl),td=ns({append:function(n){return function(e){var t=tf(n.get());return e.subscribe(t.set),n.subscribe(t.set),t}}});f=th(32)(),R=ts(function(n){return n?new nw(eZ.value):nh.value})(eZ.value)(f),l=th(40)(),C=ts(function(n){return n?new nw(eZ.value):nh.value})(eZ.value)(l),v=th(38)(),S=tp(function(n){return n?eG.value:eH.value})(v),s=th(37)(),q=tp(function(n){return n?eJ.value:eK.value})(s),m=th(39)(),k=tp(function(n){return n?eQ.value:eW.value})(m),window.requestAnimationFrame?(n=window.requestAnimationFrame,window.cancelAnimationFrame):window.mozRequestAnimationFrame?(n=window.mozRequestAnimationFrame,window.mozCancelAnimationFrame):window.webkitRequestAnimationFrame?(n=window.webkitRequestAnimationFrame,window.webkitCancelAnimationFrame):window.msRequestAnimationFrame?(n=window.msRequestAnimationFrame,window.msCancelAnimationFrame):window.oRequestAnimationFrame?(n=window.oRequestAnimationFrame,window.oCancelAnimationFrame):(n=function(n){setTimeout(function(){n(tm())},1e3/60)},window.clearTimeout),e=tf(tm()),n(function t(r){e.set(r),n(t)}),V=e,z=tw(tw((h="myCanvas",w=nw.create,y=nh.value,function(){var n=document.getElementById(h);return n&&n instanceof HTMLCanvasElement?w(n):y}))(ny(nX(Error("could not find canvas")))(ty)))(function(n){return function(){return n.getContext("2d")}})(),N=td(R)(td(C)(td(S)(td(q)(k)))),O=td(tp(function(n){return new eP(n)})((p=$(16),d=tf(tm()),setInterval(function(){d.set(tm())},p),d)))(N),B=(j=function(n){return function(e){if(n instanceof eG)return{game:e.game,input:{left:e.input.left,right:e.input.right,up:!0}};if(n instanceof eH)return{game:e.game,input:{left:e.input.left,right:e.input.right,up:!1}};if(n instanceof eJ)return{game:e.game,input:{up:e.input.up,right:e.input.right,left:!0}};if(n instanceof eK)return{game:e.game,input:{up:e.input.up,right:e.input.right,left:!1}};if(n instanceof eQ)return{game:e.game,input:{up:e.input.up,left:e.input.left,right:!0}};if(n instanceof eW)return{game:e.game,input:{up:e.input.up,left:e.input.left,right:!1}};if(n instanceof eP&&e.game instanceof eX)return e.input.up?{input:e.input,game:new eY(e7(0))}:{input:e.input,game:eX.value};if(n instanceof eP&&e.game instanceof eI)return n.value0>e.game.value1+350&&e.input.up?{input:e.input,game:new eY(e7(e.game.value0.high))}:{input:e.input,game:new eI(e.game.value0,e.game.value1)};if(n instanceof eP&&e.game instanceof eY){var t,r,u,o,i,c,a=eh(nR(nE(n.value0))),f=eU(eV)(e8)(new ee((t=e.input,function(n){var e=t.right?5:0,r=t.left?0-5:0,u=n.rotDeg+r+e;return{x:n.x,y:n.y,vel:n.vel,score:n.score,collects:n.collects,avoids:n.avoids,spawns:n.spawns,level:n.level,high:n.high,comboLevel:n.comboLevel,combo:n.combo,comboTime:n.comboTime,rotDeg:u>360?u-360:u<0?u+360:u}}),new ee((r=e.input,function(n){var e=r.up?{x:.1*nF(tu(n.rotDeg)),y:.1*nT(tu(n.rotDeg))}:e$;return{x:n.x,y:n.y,rotDeg:n.rotDeg,score:n.score,collects:n.collects,avoids:n.avoids,spawns:n.spawns,level:n.level,high:n.high,comboLevel:n.comboLevel,combo:n.combo,comboTime:n.comboTime,vel:{x:n.vel.x+e.x,y:n.vel.y-e.y}}}),new ee((o=n.value0,function(n){return function(e){var t=function(n){return tt(e.x)(e.y)(n.x)(n.y)<(25+10)/2},r=el(function(n){return!t(n)})(e.collects),u=el(t)(e.collects),i=eC(function(n){var e=e3(0)(800)(2)(eh(n));return e instanceof ee&&e.value1 instanceof ee&&e.value1.value1 instanceof en?{x:eq(50)(800-50)(e.value0),y:eq(50)(600-50)(e.value1.value0)}:nG("unreachable")})(e1(0)(2e9)(ef(u))(n)),c=ef(u),a=ek(r)(i),f=c+(c*e.comboLevel|0)|0,l=c>0?new n_(1,new n_(e.comboLevel+c|0,new nw(o))):new n_(e.combo,new n_(e.comboLevel,e.comboTime));return{x:e.x,y:e.y,rotDeg:e.rotDeg,vel:e.vel,avoids:e.avoids,spawns:e.spawns,level:e.level,high:e.high,collects:a,score:e.score+f|0,combo:l.value0,comboLevel:l.value1.value0,comboTime:l.value1.value1}}})(a),new ee(e6,new ee(ti,new ee(ta,new ee(tc,new ee((u=n.value0,function(n){var e,t=(e=eC(function(n){return eh(n)})(e2(2)(a)))instanceof ee&&e.value1 instanceof ee&&e.value1.value1 instanceof en?new n_(e.value0,e.value1.value0):nG("unreachable"),r=n.score<10?0:n.score<20?1:n.score<30?2:n.score<50?3:nR(nL($(n.score)/50))+3|0,o=r-n.level|0,i=eC(function(n){return tn(n)(50)})(e2(o)(t.value0)),c=eC(function(n){var e=tn(n)(75);return{x:e.x,y:e.y,timeCreated:u}})(e2(o)(t.value1));return{x:n.x,y:n.y,rotDeg:n.rotDeg,vel:n.vel,score:n.score,avoids:n.avoids,high:n.high,comboLevel:n.comboLevel,combo:n.combo,comboTime:n.comboTime,collects:ek(n.collects)(i),spawns:ek(n.spawns)(c),level:r}}),new ee(e_,new ee((i=n.value0,function(n){var e,t=function(n){return function(e){return n>e.timeCreated+1e3}},r=eC(function(n){return{x:n.x,y:n.y,vel:e$}})(el(t(i))(n.spawns)),u=el((e=t(i),function(n){return!e(n)}))(n.spawns);return{x:n.x,y:n.y,rotDeg:n.rotDeg,vel:n.vel,score:n.score,collects:n.collects,level:n.level,high:n.high,comboLevel:n.comboLevel,combo:n.combo,comboTime:n.comboTime,spawns:u,avoids:ek(n.avoids)(r)}}),new ee((c=n.value0,function(n){var e=function(){if(n.comboTime instanceof nw)return 1-(c-n.comboTime.value0)/3300;if(n.comboTime instanceof nh)return 0;throw Error("Failed pattern match at Lib (line 379, column 15 - line 381, column 21): "+[n.comboTime.constructor.name])}(),t=eq(0)(1)(e),r=0===t?0:n.comboLevel;return{x:n.x,y:n.y,rotDeg:n.rotDeg,vel:n.vel,score:n.score,collects:n.collects,avoids:n.avoids,spawns:n.spawns,level:n.level,high:n.high,comboTime:n.comboTime,combo:t,comboLevel:r}}),en.value))))))))))))(e.game.value0),l=new ee(te,new ee(to,en.value));return eS(function(n){return n(e.game.value0)})(l)?{input:e.input,game:new eI(f,n.value0)}:{input:e.input,game:new eY(f)}}return e}},function(n){return function(e){var t=n,r=tf(t);return e.subscribe(function(n){t=j(n)(t),r.set(t)}),r}})(e9)(O),(g=tf((x=tp(function(n){var e=function(n){return function(e){return function(t){return function(r){return function(u){return function(o){return nH(z)(function(){var i,c;return(i=ez(t)+"px Monospace",function(){z.font=i})(),nY(z)(o)(),nP(z)({translateX:r.x,translateY:r.y})(),nI(z)(tu(u))(),(c=e.x-r.x,function(e){return function(){z.fillText(n,c,e)}})(e.y-r.y)()})}}}}}},t=function(n){return function(e){return function(t){return function(r){return nH(z)(function(){var u,o;return nY(z)(r)(),nP(z)({translateX:e.x,translateY:e.y})(),nI(z)(tu(t))(),(u={x:n.x-e.x,y:n.y-e.y,width:n.width,height:n.height},o=function(){z.rect(u.x,u.y,u.width,u.height)},function(){z.beginPath();var n=o();return z.fill(),n})()})}}}};return function(){(r={x:0,y:0,width:800,height:600},function(){z.clearRect(r.x,r.y,r.width,r.height)})(),t({x:0,y:0,width:800,height:600})(e$)(0)("black")();var r,u=function(n){var r="score: "+ez(n.score);return function(){e(r)({x:0,y:25})(30)(e$)(0)("white")(),e("high: "+ez(n.high))({x:600,y:25})(30)(e$)(0)("white")(),e("Combo: "+ez(n.comboLevel))({x:0,y:575})(30)(e$)(0)("white")(),t({x:10,y:585,width:780*n.combo,height:5})(e$)(0)("gray")();var u=35/2;eN(function(n){return t({x:n.x-u,y:n.y-u,width:35,height:35})({x:n.x,y:n.y})(0)("red")})(n.avoids)(),eN(function(n){return t({x:n.x-u,y:n.y-u,width:35,height:35})({x:n.x,y:n.y})(0)("blue")})(n.spawns)();var o=25/4,i={x:n.x,y:n.y},c=25/2;t({x:n.x-c,y:n.y-c,width:25,height:25})(i)(n.rotDeg)("white")(),e("/\\")({x:n.x-o,y:n.y+o})(13)(i)(n.rotDeg)("black")();var a=10/2;return eN(function(n){return t({x:n.x-a,y:n.y-a,width:10,height:10})({x:n.x,y:n.y})(0)("green")})(n.collects)()}};if(n.game instanceof eX)return e("This is you:")({x:0,y:25})(30)(e$)(0)("white")(),e("Collect these:")({x:0,y:75})(30)(e$)(0)("white")(),e("Avoid these:")({x:0,y:125})(30)(e$)(0)("white")(),e("[Up] to accelerate")({x:0,y:225})(30)(e$)(0)("white")(),e("[Left/Right] to turn")({x:0,y:275})(30)(e$)(0)("white")(),e("Press [Up] to play!")({x:0,y:375})(30)(e$)(0)("red")(),t({x:300,y:5,width:20,height:20})({x:0,y:0})(0)("white")(),t({x:300,y:55,width:20,height:20})({x:0,y:0})(0)("green")(),t({x:300,y:105,width:20,height:20})({x:0,y:0})(0)("red")();if(n.game instanceof eY)return u(n.game.value0)();if(n.game instanceof eI)return u(n.game.value0)(),e("Game Over!")({x:200,y:300})(50)(e$)(0)("yellow")(),e("press [Up] to play again")({x:200,y:350})(20)(e$)(0)("yellow")();throw Error("Failed pattern match at Lib (line 482, column 3 - line 498, column 94): "+[n.game.constructor.name])}})(B)).get()),V.subscribe(function(){g.set(x.get())}),function(){return g.subscribe(function(n){n()}),{}})()})();</script> </body></html>
