<!DOCTYPE html><html><head><meta charset="utf-8"><style>html,body,div,canvas{margin:0;padding:0}</style><title>GMTK2024</title></head><body> <div class="fullscreen"> <canvas id="myCanvas" width="800" height="600"></canvas> </div> <script>var n,e,t,r={},u=r={};function i(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c=[],f=!1,l=-1;function v(){f&&t&&(f=!1,t.length?c=t.concat(c):l=-1,c.length&&s())}function s(){if(!f){var n=a(v);f=!0;for(var r=c.length;r;){for(t=c,c=[];++l<r;)t&&t[l].run();l=-1,r=c.length}t=null,f=!1,function(n){if(e===clearTimeout)return clearTimeout(n);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(n);try{e(n)}catch(t){try{return e.call(null,n)}catch(t){return e.call(this,n)}}}(n)}}function h(n,e){this.fun=n,this.array=e}function w(){}u.nextTick=function(n){var e=Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];c.push(new h(n,e)),1!==c.length||f||a(s)},h.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=w,u.addListener=w,u.once=w,u.off=w,u.removeListener=w,u.removeAllListeners=w,u.emit=w,u.prependListener=w,u.prependOnceListener=w,u.listeners=function(n){return[]},u.binding=function(n){throw Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(n){throw Error("process.chdir is not supported")},u.umask=function(){return 0},(()=>{var n,e,t,u,i,o,a,c,f,l,v,s,h,w,d,m,g,p,y,x,b,E,F,D,A,T,L,R,S,M,q,k,C,V,Y,X,z,O,N,U,j,B,I,P,H,G,J={compose:function(n){return function(e){return function(t){return n(e(t))}}}},K=function(n){return n.identity},Q={identity:function(n){return n},Semigroupoid0:function(){return J}},W=function(n){return function(e){return function(t){return n(t)(e)}}},Z=function(n){return function(e){return n}},$=void 0,_=function(n){return n.map},nn=K(Q),ne=function(n){return n.apply},nt=function(n){return n.pure},nr=function(n){var e=ne(n.Apply0()),t=nt(n);return function(n){return function(r){return e(t(n))(r)}}},nu=function(n){return n.bind},ni=function(n){return n};String.fromCharCode(65535);var no=function(n){return function(e){return function(t){return function(r){return function(u){return r<u?n:r===u?e:t}}}}},na=function(n){return function(e){return n===e}},nc={eq:na},nf={eq:na},nl=function(){function n(){}return n.value=new n,n}(),nv=function(){function n(){}return n.value=new n,n}(),ns=function(){function n(){}return n.value=new n,n}(),nh={add:function(n){return function(e){return n+e|0}},zero:0,mul:function(n){return function(e){return n*e|0}},one:1},nw={sub:function(n){return function(e){return n-e|0}},Semiring0:function(){return nh}},nd={compare:no(nl.value)(ns.value)(nv.value),Eq0:function(){return nc}},nm={compare:no(nl.value)(ns.value)(nv.value),Eq0:function(){return nf}},ng=function(n){return n.compare},np=function(n){var e=ng(n);return function(n){return function(t){var r=e(n)(t);if(r instanceof nl)return t;if(r instanceof ns||r instanceof nv)return n;throw Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[r.constructor.name])}}},ny=function(n){return n.append},nx=K(Q),nb=function(){function n(){}return n.value=new n,n}(),nE=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),nF=function(n){return function(e){return function(t){if(t instanceof nb)return n;if(t instanceof nE)return e(t.value0);throw Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[n.constructor.name,e.constructor.name,t.constructor.name])}}},nD=nF(!1)(Z(!0)),nA=function(n){return nF(n)(nx)},nT=isFinite,nL=Math.cos,nR=Math.round,nS=Math.sin,nM=(F=nE.create,function(n){return function(e){return(0|e)===e?F(e):n}})(nb.value),nq=function(n){var e=nu(n.Bind1()),t=nt(n.Applicative0());return function(n){return function(r){return e(n)(function(n){return e(r)(function(e){return t(n(e))})})}}},nk={Ring0:function(){return nw}},nC=function(n){return n.mod},nV={degree:function(n){return Math.min(Math.abs(n),2147483647)},div:function(n){return function(e){return 0===e?0:e>0?Math.floor(n/e):-Math.floor(-(n/e))}},mod:function(n){return function(e){if(0===e)return 0;var t=Math.abs(e);return(n%t+t)%t}},CommutativeRing0:function(){return nk}},nY=function(n){return n.mempty},nX=function(n,e,t){var r,u=0;return function(i){if(2===u)return r;if(1===u)throw ReferenceError(n+" was needed before it finished initializing (module "+e+", line "+i+")",e,i);return u=1,r=t(),u=2,r}},nz={Applicative0:function(){return nN},Bind1:function(){return nO}},nO={bind:function(n){return function(e){return function(){return e(n())()}}},Apply0:function(){return nj(0)}},nN={pure:function(n){return function(){return n}},Apply0:function(){return nj(0)}},nU=nX("functorEffect","Effect",function(){return{map:nr(nN)}}),nj=nX("applyEffect","Effect",function(){return{apply:nq(nz),Functor0:function(){return nU(0)}}});function nB(n){return function(){throw n}}function nI(n){return function(e){return function(){n.fillStyle=e}}}function nP(n){return function(e){return function(){n.rotate(e)}}}function nH(n){return function(e){return function(){n.translate(e.translateX,e.translateY)}}}var nG=function(n){return nB(Error(n))()},nJ=function(n){return function(e){return function(){n.save();var t=e();return n.restore(),t}}};Array.prototype.fill;var nK=function(){function n(n,e){this.head=n,this.tail=e}var e={};function t(e){return function(t){return new n(e,t)}}return function(n,r){return function(n){for(var t=[],r=0,u=n;u!==e;)t[r++]=u.head,u=u.tail;return t}(n(t)(e)(r))}}(),nQ=function(n,e,t){var r;return t.length<2?t:(function n(e,t,r,u,i,o){var a,c,f,l,v,s;for((a=i+(o-i>>1))-i>1&&n(e,t,u,r,i,a),o-a>1&&n(e,t,u,r,a,o),c=i,f=a,l=i;c<a&&f<o;)v=u[c],s=u[f],t(e(v)(s))>0?(r[l++]=s,++f):(r[l++]=v,++c);for(;c<a;)r[l++]=u[c++];for(;f<o;)r[l++]=u[f++]}(n,e,r=t.slice(0),t.slice(0),0,t.length),r)},nW=function(n){return function(e){return function(){return n(e)}}},nZ=nW(function(n){return n}),n$=nW(function(n){return n.slice()}),n_=(D=function(n,e){return e.push(n)},function(n){return function(e){return function(){return D(n,e)}}}),n0=function(n){return n.disj},n1={ff:!1,tt:!0,implies:function(n){return function(e){return n0(n1)(n1.not(n))(e)}},conj:function(n){return function(e){return n&&e}},disj:function(n){return function(e){return n||e}},not:function(n){return!n}},n2=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),n3=function(n){var e=n0(n);return{append:function(n){return function(t){return e(n)(t)}}}},n4=function(n){var e=n3(n);return{mempty:n.ff,Semigroup0:function(){return e}}},n6=function(n){return n.foldr},n5=function(n){return n.foldl},n7=function(n){var e=n6(n);return function(n){var t=ny(n.Semigroup0()),r=nY(n);return function(n){return e(function(e){return function(r){return t(n(e))(r)}})(r)}}},n8={foldr:function(n){return function(e){return function(t){for(var r=e,u=t.length,i=u-1;i>=0;i--)r=n(t[i])(r);return r}}},foldl:function(n){return function(e){return function(t){for(var r=e,u=t.length,i=0;i<u;i++)r=n(r)(t[i]);return r}}},foldMap:function(n){return n7(n8)(n)}},n9=function(n){var e=n.foldMap;return function(n){return e(n4(n))}},en=function(n){return function(e){return function(t){return n(e,t)}}},ee=function(n){return function(e){return function(t){return function(r){return n(e,t,r)}}}},et=ee(function(n,e,t){for(var r=e.length<t.length?e.length:t.length,u=Array(r),i=0;i<r;i++)u[i]=n(e[i])(t[i]);return u})(n2.create),er=en(function(n,e){return n[e]}),eu=ee(function(n,e,t){return 0===t.length?n({}):e(t[0])(t.slice(1))})(Z(nb.value))(function(n){return function(e){return new nE({head:n,tail:e})}}),ei=en(function(n,e){for(var t=n>e?-1:1,r=Array(t*(e-n)+1),u=n,i=0;u!==e;)r[i++]=u,u+=t;return r[i]=u,r}),eo=(A=function(n,e,t,r){return r<0||r>=t.length?e:n(t[r])},function(n){return function(e){return function(t){return function(r){return A(n,e,t,r)}}}})(nE.create)(nb.value),ea=function(){function n(){}return n.value=new n,n}(),ec=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),ef={map:function(n){var e;return e=ea.value,function(t){for(var r,u=e,i=!1;!i;)r=function(e,r){if(r instanceof ec&&r.value1 instanceof ec&&r.value1.value1 instanceof ec){u=new ec(r,e),t=r.value1.value1.value1;return}return i=!0,function(t){for(var r,u=e,i=!1;!i;)r=function(e,r){if(e instanceof ec&&e.value0 instanceof ec&&e.value0.value1 instanceof ec&&e.value0.value1.value1 instanceof ec){u=e.value1,t=new ec(n(e.value0.value0),new ec(n(e.value0.value1.value0),new ec(n(e.value0.value1.value1.value0),r)));return}return i=!0,r}(u,t);return r}(r instanceof ec&&r.value1 instanceof ec&&r.value1.value1 instanceof ea?new ec(n(r.value0),new ec(n(r.value1.value0),ea.value)):r instanceof ec&&r.value1 instanceof ea?new ec(n(r.value0),ea.value):ea.value)}(u,t);return r}}},el=_(ef),ev={foldr:function(n){return function(e){var t,r=(t=ea.value,function(n){for(var e,r=t,u=!1;!u;)e=function(e,t){if(t instanceof ea)return u=!0,e;if(t instanceof ec){r=new ec(t.value0,e),n=t.value1;return}throw Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[e.constructor.name,t.constructor.name])}(r,n);return e}),u=n5(ev)(W(n))(e);return function(n){return u(r(n))}}},foldl:function(n){return function(e){return function(t){for(var r,u=e,i=!1;!i;)r=function(e,r){if(r instanceof ea)return i=!0,e;if(r instanceof ec){u=n(e)(r.value0),t=r.value1;return}throw Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[r.constructor.name])}(u,t);return r}}},foldMap:function(n){var e=ny(n.Semigroup0()),t=nY(n);return function(n){return n5(ev)(function(t){var r=e(t);return function(e){return r(n(e))}})(t)}}},es=n5(ev),eh=n6(ev),ew=ny({append:function(n){return function(e){return eh(ec.create)(e)(n)}}}),ed={unfoldr1:function(n){return function(e){return function(t){for(var r,u=e,i=!1;!i;)r=function(e,r){var o=n(e);if(o.value1 instanceof nE){u=o.value1.value0,t=new ec(o.value0,r);return}if(o.value1 instanceof nb)return i=!0,es(W(ec.create))(ea.value)(new ec(o.value0,r));throw Error("Failed pattern match at Data.List.Types (line 135, column 22 - line 137, column 61): "+[o.constructor.name])}(u,t);return r}(ea.value)}}},em={apply:function(n){return function(e){if(n instanceof ea)return ea.value;if(n instanceof ec)return ew(el(n.value0)(e))(ne(em)(n.value1)(e));throw Error("Failed pattern match at Data.List.Types (line 157, column 1 - line 159, column 48): "+[n.constructor.name,e.constructor.name])}},Functor0:function(){return ef}},eg={bind:function(n){return function(e){if(n instanceof ea)return ea.value;if(n instanceof ec)return ew(e(n.value0))(nu(eg)(n.value1)(e));throw Error("Failed pattern match at Data.List.Types (line 164, column 1 - line 166, column 37): "+[n.constructor.name,e.constructor.name])}},Apply0:function(){return em}},ep=nu(eg),ey=K(Q),ex=function(n){if(n instanceof ea)return nb.value;if(n instanceof ec)return new nE(n.value0);throw Error("Failed pattern match at Data.List (line 230, column 1 - line 230, column 22): "+[n.constructor.name])},eb=nC(nV),eE=function(n){if(n instanceof nE)return n.value0;throw Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[n.constructor.name])},eF=function(n){var e;return(e=eb(n)(2147483645))<1?e+2147483646|0:e},eD=function(n){var e;return eE(nM((e=ni(48271)*ni(n)+ni(0),function(n){return e%n})(ni(2147483647))))},eA=_({map:function(n){return function(e){return function(){return n(e())}}}})(Z($)),eT=nC(nV),eL=function(n){return n.randomR},eR=function(n){var e=(n.Random0(),function(n){return function(e){return function(t){var r;return(r=function(r){return function(){var u,i={value:t};return(u=function(e){return function(){var e,t=n(i.value);return eA((e=t.newSeed,function(n){return function(){return n.value=e}})(i))(),eA(n_(t.newVal)(r))()}},function(){for(var n=0;n<e;n++)u(n)()})()}},function(n){return function(){var e=n$(n)();return r(e)(),nZ(e)()}})([])()}}}),t=eL(n);return function(n){return function(r){return e(t(n)(r))}}},eS={random:function(n){var e=eD(n);return{newVal:e,newSeed:e}}},eM=function(n){return n.random},eq=eM(eS),ek={random:function(n){var e=eq(n);return{newVal:ni(e.newVal)/ni(2147483647),newSeed:e.newSeed}}},eC=eM(ek),eV={randomR:function(n){return function(e){return function(t){if(n>e)return eL(eV)(e)(n)(t);var r=eq(t);return{newVal:eT(r.newVal)((e-n|0)+1|0)+n|0,newSeed:r.newSeed}}}},Random0:function(){return eS}},eY={randomR:function(n){return function(e){return function(t){if(n>e)return eL(eY)(e)(n)(t);var r=eC(t);return{newVal:r.newVal*(e-n)+n,newSeed:r.newSeed}}}},Random0:function(){return ek}},eX=np(nm),ez=(t=function(n){return function(e){return function(t){for(var r,u=e,i=!1;!i;)r=function(e,r){var o=n(e);if(o instanceof nb)return i=!0,es(W(ec.create))(ea.value)(r);if(o instanceof nE){u=o.value0.value1,t=new ec(o.value0.value0,r);return}throw Error("Failed pattern match at Data.List.Types (line 142, column 22 - line 144, column 52): "+[o.constructor.name])}(u,t);return r}(ea.value)}},function(n){var e=n.length;return t(function(t){return t<e?new nE(new n2(er(n)(t),t+1|0)):nb.value})(0)}),eO=_(ef),eN=n9(ev)(n1),eU=_({map:function(n){return function(e){for(var t=e.length,r=Array(t),u=0;u<t;u++)r[u]=n(e[u]);return r}}}),ej=(u=ng(nd),T=function(n){return function(e){var t=u(n)(e);if(t instanceof nl||t instanceof ns)return n;if(t instanceof nv)return e;throw Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[t.constructor.name])}},L=np(nd),function(n){return function(e){return function(t){return T(e)(L(n)(t))}}}),eB=en(nK)(n6(ev)),eI=ng(nd),eP=n6(ev),eH=J.compose,eG=n9(n8)(n1),eJ=function(n){return n.toString()},eK=(o=ne(i=nN.Apply0()),a=_(i.Functor0()),R=function(n){return function(e){return o(a(Z(nn))(n))(e)}},S=nt(nN),function(n){var e=n6(n);return function(n){return e(function(e){return R(n(e))})(S($))}}),eQ=eK(ev),eW=eK(n8),eZ=(M=nt(nN),function(n){return function(e){if(n)return e;if(!n)return M($);throw Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[n.constructor.name,e.constructor.name])}}),e$=function(){function n(){}return n.value=new n,n}(),e_=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),e0=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),e1=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),e2=function(){function n(n){this.value0=n}return n.create=function(e){return new n(e)},n}(),e3=function(){function n(n,e){this.value0=n,this.value1=e}return n.create=function(e){return function(t){return new n(e,t)}},n}(),e4=function(){function n(){}return n.value=new n,n}(),e6=function(){function n(){}return n.value=new n,n}(),e5=function(){function n(){}return n.value=new n,n}(),e7=function(){function n(){}return n.value=new n,n}(),e8=function(){function n(){}return n.value=new n,n}(),e9=function(){function n(){}return n.value=new n,n}(),tn=function(){function n(){}return n.value=new n,n}(),te={x:0,y:0},tt=function(n){return{tree:n.tree,choices:n.choices,level:n.level,seed:n.seed,avoids:n.avoids,history:n.history,high:eX(n.level)(n.high)}},tr=function(n){var e=eo(n.choices)(0);if(e instanceof nE)return{x:e.value0.x,y:e.value0.y};if(e instanceof nb)return nG("unreachable");throw Error("Failed pattern match at Lib (line 237, column 15 - line 239, column 46): "+[e.constructor.name])},tu=function(n){var e=eR(n);return function(n){return function(t){return function(r){return function(u){var i=eu(e(n)(t)(r+1|0)(u));if(i instanceof nE)return ez(i.value0.tail);if(i instanceof nb)return nG("unreachable");throw Error("Failed pattern match at Lib (line 375, column 31 - line 377, column 46): "+[i.constructor.name])}}}}},ti=tu(eV),to=tu(eY),ta=function(n){var e=tu(n);return function(n){return function(t){return function(r){var u=e(n)(t)(1)(r);return u instanceof ec&&u.value1 instanceof ea?u.value0:nG("unreachable")}}}},tc=ta(eV),tf=ta(eY),tl=function(n){return function(e){return eO(function(n){return eF(n)})(ti(0)(2e9)(n)(e))}},tv=e$.value,ts=function(n){return function(e){return{tree:new ec([{x:400,y:600,width:60,angleDeg:0,length:150}],ea.value),choices:[{x:400,y:450,width:20,angleDeg:-45,length:75},{x:400,y:450,width:20,angleDeg:0,length:75},{x:400,y:450,width:20,angleDeg:45,length:75}],level:0,seed:n,avoids:ea.value,high:e,history:ea.value}}},th=function(n){var e=tr(n);return eN(function(n){return e.x>=n.x&&e.x<=n.x+n.width&&e.y>=n.y&&e.y<=n.y+n.height})(n.avoids)},tw=function(n){var e=tr(n);return e.x<0||e.x>800||e.y>600},td=function(n){return 3.14159265359*n/180},tm=function(n){if(tr(n).y<80){var e,t,r,u,i=function(){var e=ex(n.tree);if(e instanceof nE)return new ec(eU(function(n){return{angleDeg:n.angleDeg,length:n.length,width:n.width,x:n.x,y:n.y+520}})(e.value0),ea.value);if(e instanceof nb)return nG("unreachable");throw Error("Failed pattern match at Lib (line 144, column 17 - line 146, column 54): "+[e.constructor.name])}(),o=n.level+1|0,a=new ec(new n2(n.level,n.tree),n.history),c=eU(function(n){return{angleDeg:n.angleDeg,length:n.length,width:n.width,x:n.x,y:n.y+520}})(n.choices),f=(t=(e=tl(2)(n.seed))instanceof ec&&e.value1 instanceof ec&&e.value1.value1 instanceof ea?new n2(e.value0,e.value1.value0):nG("unreachable"),eO((u=.3*ni(7-(r=tc(2)(6)(t.value0))|0)+1,function(n){var e,t,r,i=(e=tl(2)(n))instanceof ec&&e.value1 instanceof ec&&e.value1.value1 instanceof ea?new n2(e.value0,e.value1.value0):nG("unreachable"),o=(t=to(0)(800)(2)(i.value0))instanceof ec&&t.value1 instanceof ec&&t.value1.value1 instanceof ea?new n2(t.value0,t.value1.value0):nG("unreachable"),a=(r=to(30)(60)(2)(i.value1))instanceof ec&&r.value1 instanceof ec&&r.value1.value1 instanceof ea?new n2(r.value0,r.value1.value0):nG("unreachable"),c=a.value0*u,f=ej(100)(700)(o.value0)-c/2,l=a.value1*u;return{x:f,y:ej(100)(300)(o.value1)-l/2,width:c,height:l}}))(tl(r)(t.value1)));return{seed:n.seed,high:n.high,level:o,choices:c,tree:i,avoids:f,history:a}}return n},tg=function(n){var e=n.length*nL(td(n.angleDeg)),t=n.length*nS(td(n.angleDeg));return{x:n.x+t,y:n.y-e}},tp=function(n){return function(e){return function(t){var r=function(){var r,u,i,o=eo(t.choices)(e);if(o instanceof nE){return r=o.value0,i=eU(function(n){var e,t,u=(t=tl(3)(n))instanceof ec&&t.value1 instanceof ec&&t.value1.value1 instanceof ec&&t.value1.value1.value1 instanceof ea?new n2(t.value0,new n2(t.value1.value0,t.value1.value1.value0)):nG("unreachable"),i=ej(3)(15)(tf(-5)(5)(u.value0)+r.width),o=tg(r),a=ej(30)(120)(tf(-30)(30)(u.value1.value1)+r.length),c=(e=tf(-60)(60)(u.value1.value0)+r.angleDeg)>=-540&&e<-180?e+360:e>180&&e<=540?e-360:e>=-180&&e<=180?e:nG("unimplemented");return{x:o.x,y:o.y,width:i,angleDeg:c,length:a}})(eB(tl(3)(n))),(u=function(n){return function(e){return eI(n.angleDeg)(e.angleDeg)}},ee(nQ)(u)(function(n){if(n instanceof nv)return 1;if(n instanceof ns)return 0;if(n instanceof nl)return -1;throw Error("Failed pattern match at Data.Array (line 897, column 38 - line 900, column 11): "+[n.constructor.name])}))(i)}if(o instanceof nb)return nG("index out of range");throw Error("Failed pattern match at Lib (line 230, column 18 - line 232, column 57): "+[o.constructor.name])}();return{level:t.level,seed:t.seed,avoids:t.avoids,high:t.high,history:t.history,choices:r,tree:new ec(t.choices,t.tree)}}}};function ty(n){var e=[],t=n;return{subscribe:function(n){e.push(n),n(t)},get:function(){return t},set:function(n){t=n,e.forEach(function(e){e(n)})}}}var tx={map:function(n){return function(e){var t=ty(n(e.get()));return e.subscribe(function(e){t.set(n(e))}),t}}},tb=_(tx),tE=function(n){return function(e){return function(t){var r;return tb(nA(e))((r=new nE(e),function(n){var e=ty(nD(n.get())?n.get():r);return n.subscribe(function(n){nD(n)&&e.set(n)}),e})(tb(n)(t)))}}};function tF(){var n="undefined"!=typeof performance?performance:null,e=void 0!==r?r:null;return(n&&(n.now||n.webkitNow||n.msNow||n.oNow||n.mozNow)||e&&e.hrtime&&function(){var n=e.hrtime();return(1e9*n[0]+n[1])/1e6}||Date.now).call(n)}var tD=function(){function n(){}return n.value=new n,n}(),tA=function(){function n(){}return n.value=new n,n}(),tT=function(){function n(){}return n.value=new n,n}(),tL=function(){function n(){}return n.value=new n,n}(),tR=(q=ty({x:0,y:0}),window.addEventListener("mousemove",function(n){if(void 0!==n.pageX&&void 0!==n.pageY)q.set({x:n.pageX,y:n.pageY});else if(void 0!==n.clientX&&void 0!==n.clientY)q.set({x:n.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:n.clientY+document.body.scrollTop+document.documentElement.scrollTop});else throw Error("Mouse event has no coordinates I recognise!")}),function(){return q}),tS=function(n){var e;return e=function(){if(n instanceof tD)return 0;if(n instanceof tL)return 2;if(n instanceof tA)return 1;if(n instanceof tT)return 4;throw Error("Failed pattern match at Signal.DOM (line 48, column 20 - line 52, column 32): "+[n.constructor.name])}(),function(){var n=ty(!1);return window.addEventListener("mousedown",function(t){t.button===e&&n.set(!0)}),window.addEventListener("mouseup",function(t){t.button===e&&n.set(!1)}),n}},tM=function(n){return function(){var e=ty(!1);return window.addEventListener("keydown",function(t){t.keyCode===n&&e.set(!0)}),window.addEventListener("keyup",function(t){t.keyCode===n&&e.set(!1)}),e}},tq=nu(nO),tk=nt(nN),tC=_(tx),tV=ny({append:function(n){return function(e){var t=ty(n.get());return e.subscribe(t.set),n.subscribe(t.set),t}}});c=tR(),k=tC(function(n){return new e3(ni(n.x),ni(n.y))})(c),f=tS(tD.value)(),C=tE(function(n){return n?new nE(e4.value):nb.value})(e4.value)(f),l=tS(tL.value)(),V=tE(function(n){return n?new nE(e6.value):nb.value})(e6.value)(l),v=tM(32)(),Y=tE(function(n){return n?new nE(tn.value):nb.value})(tn.value)(v),s=tM(38)(),X=tE(function(n){return n?new nE(e5.value):nb.value})(e5.value)(s),h=tM(40)(),z=tE(function(n){return n?new nE(e7.value):nb.value})(e7.value)(h),w=tM(37)(),O=tE(function(n){return n?new nE(e8.value):nb.value})(e8.value)(w),d=tM(39)(),N=tE(function(n){return n?new nE(e9.value):nb.value})(e9.value)(d),window.requestAnimationFrame?(n=window.requestAnimationFrame,window.cancelAnimationFrame):window.mozRequestAnimationFrame?(n=window.mozRequestAnimationFrame,window.mozCancelAnimationFrame):window.webkitRequestAnimationFrame?(n=window.webkitRequestAnimationFrame,window.webkitCancelAnimationFrame):window.msRequestAnimationFrame?(n=window.msRequestAnimationFrame,window.msCancelAnimationFrame):window.oRequestAnimationFrame?(n=window.oRequestAnimationFrame,window.oCancelAnimationFrame):(n=function(n){setTimeout(function(){n(tF())},1e3/60)},window.clearTimeout),e=ty(tF()),n(function t(r){e.set(r),n(t)}),U=e,j=tq(tq((m="myCanvas",g=nE.create,p=nb.value,function(){var n=document.getElementById(m);return n&&n instanceof HTMLCanvasElement?g(n):p}))(nF(nB(Error("could not find canvas")))(tk)))(function(n){return function(){return n.getContext("2d")}})(),B=tV(k)(tV(C)(V)),I=tV(Y)(tV(X)(tV(z)(tV(O)(N)))),P=tV(tC(function(n){return new e2(n)})((y=ni(16),x=ty(tF()),setInterval(function(){x.set(tF())},y),x)))(tV(B)(I)),G=(H=function(n){return function(e){if(n instanceof e8&&e instanceof e_)return new e_(tp(e.value0.seed)(0)(e.value0));if(n instanceof e5&&e instanceof e_)return new e_(tp(e.value0.seed)(1)(e.value0));if(n instanceof e9&&e instanceof e_)return new e_(tp(e.value0.seed)(2)(e.value0));if(n instanceof tn&&e instanceof e0)return new e1(e.value0,0);if(n instanceof tn&&e instanceof e1)return new e_(ts(e.value0.seed)(e.value0.high));if(n instanceof e5&&e instanceof e1)return new e1(e.value0,0);if(n instanceof tn&&e instanceof e$)return new e_(ts(eF(0))(0));if(n instanceof e2&&e instanceof e1)return e.value1<500*ni(e.value0.level)?new e1(e.value0,e.value1+2):new e1(e.value0,e.value1);if(n instanceof e2&&e instanceof e_){var t,r=eP(eH)((t=n.value0,function(n){var e;return{tree:n.tree,choices:n.choices,level:n.level,avoids:n.avoids,high:n.high,history:n.history,seed:eF(nT(e=nR(t))?e>=ni(2147483647)?2147483647:e<=ni(-2147483648)?-2147483648:nA(0)(nM(e)):0)}}))(new ec(tm,new ec(tt,ea.value)))(e.value0);return eG(function(n){return n(e.value0)})([tw,th])?new e0({tree:e.value0.tree,choices:e.value0.choices,level:e.value0.level,seed:e.value0.seed,avoids:e.value0.avoids,high:e.value0.high,history:new ec(new n2(e.value0.level,e.value0.tree),e.value0.history)}):new e_(r)}return e}},function(n){return function(e){var t=n,r=ty(t);return e.subscribe(function(n){t=H(n)(t),r.set(t)}),r}})(tv)(P),(E=ty((b=tC(function(n){var e=function(n){return function(e){return function(t){return function(r){return function(u){return function(i){return nJ(j)(function(){var o,a;return(o=eJ(t)+"px Monospace",function(){j.font=o})(),nI(j)(i)(),nH(j)({translateX:r.x,translateY:r.y})(),nP(j)(td(u))(),(a=e.x-r.x,function(e){return function(){j.fillText(n,a,e)}})(e.y-r.y)()})}}}}}},t=function(n){return function(e){return function(t){return function(r){return nJ(j)(function(){var u,i;return nI(j)(r)(),nH(j)({translateX:e.x,translateY:e.y})(),nP(j)(td(t))(),(u={x:n.x-e.x,y:n.y-e.y,width:n.width,height:n.height},i=function(){j.rect(u.x,u.y,u.width,u.height)},function(){j.beginPath();var n=i();return j.fill(),n})()})}}}};return function(){(r={x:0,y:0,width:800,height:600},function(){j.clearRect(r.x,r.y,r.width,r.height)})(),t({x:0,y:0,width:800,height:600})(te)(0)("black")();var r,u=function(n){return function(e){var r=e.width/2;return t({x:e.x-r,y:e.y-e.length,width:e.width,height:e.length})({x:e.x,y:e.y})(e.angleDeg)(n)}},i=function(n){return function(r){return function(){return t({x:0,y:80,width:800,height:7})(te)(0)("purple")(),e(eJ(n.level))({x:20,y:50})(50)(te)(0)("white")(),e("high score: "+eJ(n.high))({x:500,y:40})(30)(te)(0)("white")(),eQ(function(n){return t(n)(te)(0)("orange")})(n.avoids)(),eQ(function(n){return eW(u("brown"))(n)})(n.tree)(),eZ(r)(function(){return eW(function(n){return u(n.value1)(n.value0)})(et(n.choices)(["red","green","blue"]))(),eW(function(t){var r=eo(n.choices)(t.value0);if(r instanceof nE){var u=tg(r.value0);return e(t.value1)(u)(20)(te)(0)("white")}if(r instanceof nb)return nG("index out of bounds");throw Error("Failed pattern match at Lib (line 286, column 35 - line 291, column 66): "+[r.constructor.name])})(et(ei(0)(2))(["Left","Up","Right"]))()})()}}};if(n instanceof e_)return i(n.value0)(!0)();if(n instanceof e0)return i(n.value0)(!1)(),e("YOU ARE DEAD")({x:100,y:240})(80)(te)(0)("#66ccff")(),e("press [Space] to see tree")({x:130,y:350})(30)(te)(0)("#66ccff")();if(n instanceof e$)return e("Make the tallest tree")({x:100,y:100})(30)(te)(0)("green")(),e("Use the arrow keys to choose branches")({x:100,y:200})(30)(te)(0)("white")(),e("Avoid the orange: don't let the")({x:100,y:300})(30)(te)(0)("white")(),e("branch ends land in that area")({x:100,y:330})(30)(te)(0)("white")(),e("Press [Space] to play")({x:100,y:400})(30)(te)(0)("red")();if(n instanceof e1){var o=ep(eO(function(n){var e;return eO((e=n.value0,function(n){return eU(function(n){return{angleDeg:n.angleDeg,length:n.length,width:n.width,x:n.x,y:n.y-500*ni(e)}})(n)}))(n.value1)})(n.value0.history))(ey),a=eO(function(e){return eU(function(e){return{angleDeg:e.angleDeg,length:e.length,width:e.width,x:e.x,y:e.y+n.value1}})(e)})(o);eQ(function(n){return eW(u("brown"))(n)})(a)();var c=eU(function(e){return new n2(e,{x:20,y:600-500*ni(e)+n.value1})})(ei(0)(n.value0.level));return eW(function(n){return e(eJ(n.value0))({x:n.value1.x,y:n.value1.y})(50)(te)(0)("white")})(c)(),e("press [Up] to see tree again")({x:130,y:500})(30)(te)(0)("#66ccff")(),e("press [Space] to play again")({x:130,y:550})(30)(te)(0)("#66ccff")()}throw Error("Failed pattern match at Lib (line 297, column 3 - line 321, column 101): "+[n.constructor.name])}})(G)).get()),U.subscribe(function(){E.set(b.get())}),function(){return E.subscribe(function(n){n()}),{}})()})();</script> </body></html>
